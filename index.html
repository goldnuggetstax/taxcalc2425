<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>เครื่องคำนวณภาษีรายได้ ปีภาษี 2024-25</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for Inter font and general body */
        body {
            font-family: 'Inter', sans-serif;
            @apply bg-gray-100 flex items-center justify-center min-h-screen p-4;
        }
    </style>
</head>
<body>
    <div class="container bg-white p-8 rounded-xl shadow-lg w-full max-w-md">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">เครื่องคำนวณภาษีรายได้ ปีภาษี 2024-25</h1>

        <div class="mb-4">
            <label for="totalIncome" class="block text-gray-700 text-lg font-medium mb-2">
                ป้อนรายได้รวมก่อนหักลดหย่อน (AUD):
            </label>
            <input
                type="number"
                id="totalIncome"
                placeholder="เช่น 80000"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg"
            />
        </div>

        <div class="mb-4">
            <label for="deductions" class="block text-gray-700 text-lg font-medium mb-2">
                ป้อนค่าลดหย่อนทั้งหมด (AUD):
            </label>
            <input
                type="number"
                id="deductions"
                placeholder="เช่น 10000 (ถ้าไม่มีให้ป้อน 0)"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg"
            />
        </div>

        <div class="mb-4">
            <label for="paygWithholding" class="block text-gray-700 text-lg font-medium mb-2">
                ภาษีหัก ณ ที่จ่าย (PAYG tax withholding) (AUD):
            </label>
            <input
                type="number"
                id="paygWithholding"
                placeholder="เช่น 5000 (ถ้าไม่มีให้ป้อน 0)"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg"
            />
        </div>

        <div class="mb-6">
            <label for="paygInstalment" class="block text-gray-700 text-lg font-medium mb-2">
                ภาษีที่ผ่อนชำระ (PAYG tax instalment) (AUD):
            </label>
            <input
                type="number"
                id="paygInstalment"
                placeholder="เช่น 1000 (ถ้าไม่มีให้ป้อน 0)"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg"
            />
        </div>

        <button
            onclick="calculateTax()"
            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 ease-in-out transform hover:scale-105 shadow-md"
        >
            คำนวณภาษี
        </button>

        <div id="result" class="mt-8 p-6 bg-blue-50 border border-blue-200 rounded-lg text-gray-800 text-center font-semibold hidden">
            <!-- Result will be displayed here -->
        </div>

        <div class="mt-6 text-sm text-gray-500 text-center">
            <p>ข้อจำกัดความรับผิดชอบ: เครื่องคำนวณนี้เป็นเพียงการประมาณการเท่านั้น โดยอิงตามอัตราภาษีสำหรับผู้มีถิ่นที่อยู่ในออสเตรเลียสำหรับปีภาษี 2024-2025 (รวมถึงการลดหย่อนภาษีระยะที่ 3) และการคำนวณภาษี Medicare Levy ขั้นพื้นฐาน **มีการพิจารณาค่าลดหย่อนที่คุณป้อน, Low-Income Tax Offset (LITO), ภาษีหัก ณ ที่จ่าย (PAYG tax withholding) และภาษีที่ผ่อนชำระ (PAYG tax instalment)** แต่ไม่ได้พิจารณาสถานการณ์ส่วนบุคคลทั้งหมด, การลดหย่อนภาษีเฉพาะประเภท, หรือกฎหมายภาษีที่ซับซ้อนอื่น ๆ โปรดปรึกษา <a href="https://www.facebook.com/goldnuggetsaccounting/" class="text-blue-600 hover:underline" target="_blank">ผู้เชี่ยวชาญด้านภาษี หรือสำนักงานบัญชี บัญชี ภาษี ออสซี่</a> เพื่อขอคำแนะนำส่วนบุคคล</p>
        </div>
    </div>

    <script>
        /**
         * Formats a number as a currency string with two decimal places and commas.
         * @param {number} amount - The number to format.
         * @returns {string} The formatted currency string.
         */
        function formatCurrency(amount) {
            return amount.toLocaleString('en-AU', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        /**
         * Calculates the estimated tax payable based on Australian tax rates.
         * This function retrieves the total income, deductions, PAYG withholding, and PAYG instalment from the input fields,
         * calculates the taxable income, validates inputs, and then applies the progressive tax rates,
         * Low-Income Tax Offset (LITO), and Medicare Levy for Australian residents for the 2024-2025 income year.
         * Finally, it determines the tax refund or amount owing.
         * The result is displayed in the 'result' div.
         */
        function calculateTax() {
            // Get the input elements and their values
            const totalIncomeInput = document.getElementById('totalIncome');
            const deductionsInput = document.getElementById('deductions');
            const paygWithholdingInput = document.getElementById('paygWithholding');
            const paygInstalmentInput = document.getElementById('paygInstalment');
            
            let totalIncome = parseFloat(totalIncomeInput.value);
            let deductions = parseFloat(deductionsInput.value);
            let paygWithholding = parseFloat(paygWithholdingInput.value);
            let paygInstalment = parseFloat(paygInstalmentInput.value);

            const resultDiv = document.getElementById('result');

            // Reset result display and styling
            resultDiv.classList.add('hidden');
            resultDiv.classList.remove('bg-red-100', 'border-red-400', 'text-red-700');
            resultDiv.classList.add('bg-blue-50', 'border-blue-200', 'text-gray-800');

            // --- Input Validation ---
            if (isNaN(totalIncome) || totalIncome < 0) {
                resultDiv.innerHTML = "<p>โปรดป้อนตัวเลขที่เป็นบวกที่ถูกต้องสำหรับรายได้รวมของคุณ</p>";
                resultDiv.classList.remove('hidden');
                resultDiv.classList.add('bg-red-100', 'border-red-400', 'text-red-700');
                return;
            }
            if (isNaN(deductions) || deductions < 0) {
                resultDiv.innerHTML = "<p>โปรดป้อนตัวเลขที่เป็นบวกที่ถูกต้องสำหรับค่าลดหย่อนของคุณ</p>";
                resultDiv.classList.remove('hidden');
                resultDiv.classList.add('bg-red-100', 'border-red-400', 'text-red-700');
                return;
            }
            if (isNaN(paygWithholding) || paygWithholding < 0) {
                resultDiv.innerHTML = "<p>โปรดป้อนตัวเลขที่เป็นบวกที่ถูกต้องสำหรับภาษีหัก ณ ที่จ่าย (PAYG tax withholding) ของคุณ</p>";
                resultDiv.classList.remove('hidden');
                resultDiv.classList.add('bg-red-100', 'border-red-400', 'text-red-700');
                return;
            }
            if (isNaN(paygInstalment) || paygInstalment < 0) {
                resultDiv.innerHTML = "<p>โปรดป้อนตัวเลขที่เป็นบวกที่ถูกต้องสำหรับภาษีที่ผ่อนชำระ (PAYG tax instalment) ของคุณ</p>";
                resultDiv.classList.remove('hidden');
                resultDiv.classList.add('bg-red-100', 'border-red-400', 'text-red-700');
                return;
            }

            // Calculate actual taxable income after deductions
            let taxableIncome = totalIncome - deductions;
            if (taxableIncome < 0) {
                taxableIncome = 0; // Taxable income cannot be negative
            }

            // --- Australian Tax Rates for Residents (2024-2025 Income Year) ---
            // These rates are based on the user's provided brackets, which align with
            // the legislated Stage 3 tax cuts effective from 1 July 2024.
            // Source: User provided, verified against ATO/Treasury information.
            let incomeTax = 0;

            // --- Calculate Income Tax based on provided brackets ---
            if (taxableIncome <= 18200) {
                incomeTax = 0;
            } else if (taxableIncome <= 45000) {
                // 16c for each $1 over $18,200
                incomeTax = (taxableIncome - 18200) * 0.16;
            } else if (taxableIncome <= 135000) {
                // $4,288 plus 30c for each $1 over $45,000
                incomeTax = 4288 + (taxableIncome - 45000) * 0.30;
            } else if (taxableIncome <= 190000) {
                // $31,288 plus 37c for each $1 over $135,000
                incomeTax = 31288 + (taxableIncome - 135000) * 0.37;
            } else { // Over $190,000
                // $51,638 plus 45c for each $1 over $190,000
                incomeTax = 51638 + (taxableIncome - 190000) * 0.45;
            }

            // --- Calculate Low-Income Tax Offset (LITO) ---
            let lowIncomeTaxOffset = 0;
            const LITO_MAX = 700;
            const LITO_THRESHOLD_1 = 37500;
            const LITO_THRESHOLD_2 = 45000;
            const LITO_THRESHOLD_3 = 66667; // Income above this gets no LITO

            if (taxableIncome <= LITO_THRESHOLD_1) {
                lowIncomeTaxOffset = LITO_MAX;
            } else if (taxableIncome <= LITO_THRESHOLD_2) {
                lowIncomeTaxOffset = LITO_MAX - ((taxableIncome - LITO_THRESHOLD_1) * 0.05);
            } else if (taxableIncome <= LITO_THRESHOLD_3) {
                // LITO at $45,000 is $700 - ((45000 - 37500) * 0.05) = $700 - (7500 * 0.05) = $700 - $375 = $325
                lowIncomeTaxOffset = 325 - ((taxableIncome - LITO_THRESHOLD_2) * 0.015);
            } else {
                lowIncomeTaxOffset = 0;
            }

            // Ensure LITO doesn't go below zero
            if (lowIncomeTaxOffset < 0) {
                lowIncomeTaxOffset = 0;
            }

            // --- Calculate Medicare Levy ---
            // Medicare Levy is 2% of taxable income.
            // Low-income thresholds apply, below which no levy is paid, or a reduced rate applies.
            // Using 2024-25 thresholds for single individuals as per Etax/ATO latest info.
            const medicareLevyLowerThreshold = 27222; // For single individuals (2024-25)
            const medicareLevyUpperThreshold = 34027; // Phase-out upper limit (approx. 27222 / 0.8)

            let medicareLevy = 0;
            if (taxableIncome > medicareLevyUpperThreshold) {
                medicareLevy = taxableIncome * 0.02; // Full 2% levy
            } else if (taxableIncome > medicareLevyLowerThreshold) {
                // Phase-in region: 10% of the amount over the lower threshold
                medicareLevy = (taxableIncome - medicareLevyLowerThreshold) * 0.10;
            }
            // If taxableIncome <= medicareLevyLowerThreshold, medicareLevy remains 0.

            // Calculate Gross Tax Payable before LITO
            let grossTaxPayableBeforeLITO = incomeTax; // This is the income tax calculated from brackets

            // Apply LITO (non-refundable offset, cannot reduce tax below zero)
            let netIncomeTaxAfterLITO = Math.max(0, grossTaxPayableBeforeLITO - lowIncomeTaxOffset);

            const totalTaxLiability = netIncomeTaxAfterLITO + medicareLevy;

            // --- Calculate Tax Refund or Amount Owing ---
            const totalTaxPaid = paygWithholding + paygInstalment;
            const taxRefundOrOwing = totalTaxPaid - totalTaxLiability;

            // --- Display the Result ---
            let finalResultText = '';
            let finalResultClass = 'text-blue-700'; // Default color for refund/owing

            if (taxRefundOrOwing > 0) {
                finalResultText = `คุณจะได้รับคืน: AUD ${formatCurrency(taxRefundOrOwing)}`;
                finalResultClass = 'text-green-700'; // Green for refund
            } else if (taxRefundOrOwing < 0) {
                finalResultText = `คุณต้องชำระเพิ่ม: AUD ${formatCurrency(Math.abs(taxRefundOrOwing))}`;
                finalResultClass = 'text-red-700'; // Red for amount owing
            } else {
                finalResultText = `ไม่มีภาษีที่ต้องชำระหรือได้รับคืน`;
            }

            resultDiv.innerHTML = `
                <p class="text-2xl mb-2">ผลการคำนวณภาษี:</p>
                <p class="text-4xl font-extrabold ${finalResultClass} mb-4">${finalResultText}</p>
                <p class="text-xl mb-2">รายละเอียด:</p>
                <ul class="list-disc list-inside text-left mx-auto max-w-xs space-y-1">
                    <li>รายได้ที่ต้องเสียภาษี (หลังหักลดหย่อน): AUD ${formatCurrency(taxableIncome)}</li>
                    <li class="text-red-700">ภาษีเงินได้ที่คำนวณตามขั้นบันได: AUD ${formatCurrency(grossTaxPayableBeforeLITO)}</li>
                    <li class="text-green-700">**หัก** Low-Income Tax Offset (LITO): AUD ${formatCurrency(lowIncomeTaxOffset)}</li>
                    <li class="text-red-700">**บวก** ภาษี Medicare Levy: AUD ${formatCurrency(medicareLevy)}</li>
                    <li class="font-bold">ภาษีที่ต้องชำระทั้งหมด (ก่อนหัก PAYG): AUD ${formatCurrency(totalTaxLiability)}</li>
                    <li class="text-green-700">**หัก** ภาษีหัก ณ ที่จ่าย (PAYG withholding): AUD ${formatCurrency(paygWithholding)}</li>
                    <li class="text-green-700">**หัก** ภาษีที่ผ่อนชำระ (PAYG instalment): AUD ${formatCurrency(paygInstalment)}</li>
                    <li class="font-bold text-2xl mt-4">รวมภาษีที่ต้องชำระ / ได้รับคืน: AUD ${taxRefundOrOwing > 0 ? formatCurrency(taxRefundOrOwing) : formatCurrency(Math.abs(taxRefundOrOwing))} ${taxRefundOrOwing > 0 ? '(ได้รับคืน)' : (taxRefundOrOwing < 0 ? '(ต้องชำระเพิ่ม)' : '')}</li>
                </ul>
            `;
            resultDiv.classList.remove('hidden'); // Make the result div visible
        }
    </script>
</body>
</html>
